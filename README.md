<div align="center">

# 👨‍💻 김민규 (Me-in-U)

## 🌟 All-round Developer

<div align="center">

[![Email](https://img.shields.io/badge/Email-contact@ios.kr-EA4335?style=flat-square&logo=gmail&logoColor=white)](mailto:contact@ios.kr)
[![Phone](https://img.shields.io/badge/Phone-010--9705--6500-00C73C?style=flat-square&logo=line&logoColor=white)](tel:010-9705-6500)
[![GitHub](https://img.shields.io/badge/GitHub-Me--in--U-181717?style=flat-square&logo=github&logoColor=white)](https://github.com/Me-in-U)
[![Location](https://img.shields.io/badge/Location-Busan%2C%20Korea-FF6B6B?style=flat-square&logo=google-maps&logoColor=white)](https://maps.google.com/?q=Busan,Korea)

</div>

<br>

```txt
🚀 끊임없이 성장하는 개발자
💡 새로운 기술에 도전하고, 문제를 해결하는 과정을 즐깁니다
```

</div>

<br>

---

<br>

<div align="center">

## 📑 목차 (Table of Contents)

</div>

<div align="center">

[🎓 Education & Activities](#-education--activities) •
[🛠 Tech Stack](#-tech-stack) •
[🚀 Projects](#-projects) •
[🦙 Alpacar](#01--alpacar) •
[🐙 Tako](#02--tako) •
[🤖 NAMUH](#03--namuh-tori) •
[🔗 Links](#-links)

</div>

<br>

---

<br>

<div align="center">

## 🎓 Education & Activities

</div>

<div align="center">

<table>
<tr>
<td align="center" width="33%">

### 🏛️ 학력

**[동아대학교](https://computer.donga.ac.kr/)**  
컴퓨터공학과

`2019.03 ~ 2025.02`

🎓 학사 졸업

</td>
<td align="center" width="33%">

### 💼 교육

**[SSAFY](https://www.ssafy.com/)**  
삼성 청년 SW AI 아카데미 13기

`2025.01 ~`

👨‍🏫 1학기 CA (부반장)  
📚 이수 중

</td>
<td align="center" width="33%">

### 🌐 활동

**[GDSC Dong-A University](https://gdg.community.dev/gdg-on-campus-dong-a-university-busan-south-korea/)**  
1기 ~ 2기

`2023.01 ~ 2024.09`

⭐ Core Member

</td>
</tr>
</table>

</div>

<br>

---

<br>

<div align="center">

## 🛠 Tech Stack

</div>

<br>

<table align="center">
<tr>
<td align="center" width="80px"><b>💻<br>Languages</b></td>
<td>
<img src="https://img.shields.io/badge/Java-007396?style=flat-square&logo=openjdk&logoColor=white">
<img src="https://img.shields.io/badge/Python-3776AB?style=flat-square&logo=python&logoColor=white">
<img src="https://img.shields.io/badge/Kotlin-7F52FF?style=flat-square&logo=kotlin&logoColor=white">
<img src="https://img.shields.io/badge/Dart-0175C2?style=flat-square&logo=dart&logoColor=white">
<img src="https://img.shields.io/badge/JavaScript-F7DF1E?style=flat-square&logo=javascript&logoColor=black">
<img src="https://img.shields.io/badge/C++-00599C?style=flat-square&logo=c%2B%2B&logoColor=white">
<img src="https://img.shields.io/badge/Arduino-00979D?style=flat-square&logo=arduino&logoColor=white">
</td>
</tr>
<tr>
<td align="center"><b>⚙️<br>Backend</b></td>
<td>
<img src="https://img.shields.io/badge/Spring%20Boot-6DB33F?style=flat-square&logo=springboot&logoColor=white">
<img src="https://img.shields.io/badge/Django-092E20?style=flat-square&logo=django&logoColor=white">
<img src="https://img.shields.io/badge/FastAPI-009688?style=flat-square&logo=fastapi&logoColor=white">
<img src="https://img.shields.io/badge/REST%20API-005571?style=flat-square&logo=swagger&logoColor=white">
<img src="https://img.shields.io/badge/WebSocket-1C1E24?style=flat-square&logo=websocket&logoColor=white">
<img src="https://img.shields.io/badge/MQTT-660066?style=flat-square&logo=mqtt&logoColor=white">
</td>
</tr>
<tr>
<td align="center"><b>🎨<br>Frontend<br>& Mobile</b></td>
<td>
<img src="https://img.shields.io/badge/Flutter-02569B?style=flat-square&logo=flutter&logoColor=white">
<img src="https://img.shields.io/badge/Android-3DDC84?style=flat-square&logo=android&logoColor=white">
<img src="https://img.shields.io/badge/Vue.js-4FC08D?style=flat-square&logo=vue.js&logoColor=white">
</td>
</tr>
<tr>
<td align="center"><b>💾<br>Database</b></td>
<td>
<img src="https://img.shields.io/badge/MySQL-4479A1?style=flat-square&logo=mysql&logoColor=white">
<img src="https://img.shields.io/badge/Redis-DC382D?style=flat-square&logo=redis&logoColor=white">
<img src="https://img.shields.io/badge/Firebase-FFCA28?style=flat-square&logo=firebase&logoColor=black">
</td>
</tr>
<tr>
<td align="center"><b>🔧<br>Infra<br>& Tools</b></td>
<td>
<img src="https://img.shields.io/badge/Docker-2496ED?style=flat-square&logo=docker&logoColor=white">
<img src="https://img.shields.io/badge/Nginx-009639?style=flat-square&logo=nginx&logoColor=white">
<img src="https://img.shields.io/badge/Raspberry%20Pi-C51A4A?style=flat-square&logo=raspberrypi&logoColor=white">
<img src="https://img.shields.io/badge/Home%20Assistant-41BDF5?style=flat-square&logo=home-assistant&logoColor=white">
<img src="https://img.shields.io/badge/Git-F05032?style=flat-square&logo=git&logoColor=white">
<img src="https://img.shields.io/badge/GitHub-181717?style=flat-square&logo=github&logoColor=white">
</td>
</tr>
</table>

<br>

---

<br>

<div align="center">

## 🚀 Projects

</div>

<br>

<div align="center">

|        프로젝트         | 한줄 요약                                              |            링크             |
| :---------------------: | :----------------------------------------------------- | :-------------------------: |
|   **01. 🦙 Alpacar**    | IoT & AI 기반 스마트 주차 관리 및 자율주행 보조 시스템 |  [바로가기](#01--alpacar)   |
|     **02. 🐙 Tako**     | 블록체인 & AI 기반 TCG 카드 P2P 경매 플랫폼            |    [바로가기](#02--tako)    |
| **03. 🤖 NAMUH (Tori)** | Vision AI 기반 소아암 환아 케어 휴머노이드 로봇        | [바로가기](#03--namuh-tori) |

</div>

<br>

<div align="center">

## 01. 🦙 Alpacar

**IoT & AI 기반 스마트 주차 관리 및 자율주행 보조 시스템**

<img src="https://raw.githubusercontent.com/Me-in-U/Alpacar/master/docs/assets/alpacar-onboarding-banner2.png" width="90%" style="border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">

<br><br>

![Period](<https://img.shields.io/badge/📅_Period-2025.07.14_~_2025.08.19_(6_Weeks)-blue?style=flat-square>)
![Team](<https://img.shields.io/badge/👥_Team-6_Members_(BE_1,_Emb_3,_AI_1,_FE_1)-green?style=flat-square>)
![Role](https://img.shields.io/badge/👤_Role-Backend_&_Embedded_Developer-orange?style=flat-square)

[![GitHub](https://img.shields.io/badge/GitHub-Repository-181717?style=flat-square&logo=github&logoColor=white)](https://github.com/Me-in-U/Alpacar)

</div>

<br>

<div align="center">

### 📋 프로젝트 개요

</div>

사용자의 차량 크기와 주차 실력을 고려하여 최적의 주차 공간을 자동으로 추천하는 스마트 주차 관리 시스템입니다. Raspberry Pi OCR 기반 번호판 인식, Jetson Nano 기반 실시간 차량 추적, Django REST API 서버, PWA 웹앱을 통합하여 입차부터 출차까지 전 과정을 자동화했습니다.

<br>

<div align="center">

### 🎯 담당 역할 & 기여도

</div>

<table align="center">
<tr>
<td align="center" width="33%">

**📡 Backend**

Django REST API 서버 전체 설계  
WebSocket 기반 실시간 통신  
주차 관제 로직 구현

`기여도: 100%`

</td>
<td align="center" width="33%">

**🔌 Embedded**

Raspberry Pi OCR 시스템  
Arduino 하드웨어 제어  
IoT 통신 프로토콜 설계

`기여도: 100%`

</td>
<td align="center" width="33%">

**🎨 Frontend**

관리자 페이지 개발  
실시간 대시보드 구현  
WebSocket 클라이언트 통합

`기여도: 15%`

</td>
</tr>
</table>

<br>

<div align="center">

### 🎯 구현 사항

</div>

<table align="center">
<tr>
<td width="50%">

**🔌 Backend & IoT**

- **Django REST API 서버 설계 및 구축**: Django Channels(WebSocket) 기반 실시간 양방향 통신 구현, JWT 인증, REST API 설계
- **Raspberry Pi OCR 시스템**: EasyOCR + YOLO를 활용한 한글 번호판 실시간 인식 (정확도 94%)
- **Arduino 하드웨어 제어**: WebSocket 기반 LCD 디스플레이 제어 및 입출차 게이트 시스템 연동

</td>
<td width="50%">

**🤖 AI & 실시간 시스템**

- **Jetson Nano 자율주행 보조**: YOLO11s-OBB 모델 기반 차량 추적, 라인 트레이싱, 주차 공간 점유 감지
- **실시간 주차 관제 시스템**: WebSocket을 통한 주차장 현황 실시간 모니터링, 주차 공간 상태 관리
- **FCM 푸시 알림**: 입차/주차완료/출차 시 사용자에게 실시간 알림 전송

</td>
</tr>
</table>

<br>

<div align="center">

### 🛠️ 기술 스택

</div>

<table align="center">
<tr>
<td align="center" width="25%">

**Backend**

Python, Django 5.2  
Django REST Framework  
Django Channels, WebSocket  
MySQL

</td>
<td align="center" width="25%">

**Embedded**

Raspberry Pi, Arduino  
OpenCV, EasyOCR, YOLO

</td>
<td align="center" width="25%">

**AI/ML**

Jetson Nano  
YOLO11s-OBB, PyTorch

</td>
<td align="center" width="25%">

**Frontend**

Vue 3, TypeScript  
Composition API  
WebSocket Client  
Canvas API

</td>
</tr>
</table>

<br>

<div align="center">

### 🧠 기술 선정 이유

</div>

<table align="center">
<tr>
<td width="33%">

**Django Channels (WebSocket)**

- HTTP Polling 대비 **실시간성 향상** 필요
- Raspberry Pi ↔ 서버 **양방향 통신** 구현
- Django 생태계와의 **원활한 통합**

</td>
<td width="33%">

**EasyOCR + OpenCV**

- Raspberry Pi **제한된 리소스**에서도 동작 가능
- **한글 번호판 인식 정확도** 높음
- 전처리 파이프라인 **커스터마이징 용이**

</td>
<td width="33%">

**WebSocket**

- 주차장 현황 **실시간 모니터링** 필요
- 하드웨어 제어를 위한 **저지연 양방향 통신**

</td>
</tr>
</table>

<br>

<div align="center">

### 🚀 프로젝트 성과

</div>

<details>
<summary><b>📊 1. OCR 처리 속도 10배 향상 (8.3s → 0.8s)</b></summary>

<br>

#### 🚨 문제 상황

- 초기 번호판 인식 시스템은 전체 프레임(4608x2592)을 EasyOCR로 직접 처리
- 1회 인식에 **8.3초** 소요되어 실시간 입차 시스템으로 사용 불가능

#### 💡 해결 과정

1. **YOLO 번호판 검출 도입**: Ultralytics YOLO11s-OBB로 번호판 영역만 정확히 추출
2. **ROI 기반 처리**: 전체 프레임이 아닌 번호판 영역(확장 포함)만 OCR 처리
3. **해상도 최적화**: 검출된 ROI를 333px 너비로 리사이즈하여 OCR 입력
4. **듀얼 스트림 활용**: Picamera2의 lores(2304x1296) 스트림으로 OCR 전용 처리

#### ✅ 성과

- **처리 시간**: 8.3s → **0.8s** (10.4배 단축)
- **실시간 처리**: 초당 1.25회 인식 가능 → 차량 입차 즉시 대응 가능
- **정확도 유지**: ROI 확장 전처리로 인식 정확도 유지

</details>

<details>
<summary><b>🌐 2. WebSocket 기반 실시간 통신 아키텍처 구축</b></summary>

<br>

#### 🚨 문제 상황

- 라즈베리파이(OCR) → Django → Jetson Nano(추적) → 프론트엔드(사용자)까지 다중 노드 간 실시간 데이터 전송 필요
- HTTP 폴링 방식으로는 지연시간 및 서버 부하 발생

#### 💡 해결 과정

1. **Django Channels 도입**: ASGI 기반 WebSocket 엔드포인트 구축
2. **역할별 Consumer 분리**:
   - `PiUploadConsumer`: 라즈베리파이 → Django (OCR 결과 업로드)
   - `JetsonConsumer`: Jetson ↔ Django (추적 데이터, 주차 할당)
   - `StreamConsumer`: Django → 관리자 대시보드 (실시간 모니터링)
   - `OCRTextConsumer`: Django → Arduino (출입 차단바 제어)
3. **Channel Layer 활용**: Redis 기반 메시지 브로커로 비동기 메시지 전송
4. **재연결 로직**: 모든 클라이언트(라즈베리파이, Jetson, Arduino)에 자동 재연결 구현

#### ✅ 성과

- **평균 응답 시간**: < 500ms (OCR 결과 → 프론트엔드 표시)
- **동시 연결**: 6개 노드(라즈베리파이 1, Jetson 1, Arduino 2, 프론트엔드 2) 안정적 동작
- **메시지 손실률**: 0% (재연결 메커니즘 + Channel Layer)

</details>

<br>

<div align="center">

### 💭 프로젝트 리뷰

</div>

<table align="center">
<tr>
<td width="50%">

**🔍 아쉬웠던 점**

초기 HTTP Polling 방식으로 개발하여 실시간성이 부족했으나, Django Channels(WebSocket) 도입으로 해결. 추가로 Redis를 활용한 메시지 큐 시스템을 구축했다면 더 안정적인 통신이 가능했을 것

</td>
<td width="50%">

**✨ 배운 점**

임베디드 시스템의 제한된 리소스 환경에서 성능 최적화의 중요성을 체감. 이미지 전처리 단계별 성능 측정을 통해 병목 지점을 찾아 개선하는 과정에서 프로파일링 및 최적화 역량을 크게 향상시킬 수 있었음. Django Channels를 활용한 WebSocket 실시간 통신 구현 경험을 통해 비동기 프로그래밍과 실시간 시스템 설계 역량을 습득

</td>
</tr>
</table>

<br>

---

<br>

<div align="center">

## 02. 🐙 Tako

**블록체인 & AI 기반 TCG 카드 P2P 경매 플랫폼**

<img src="https://raw.githubusercontent.com/Me-in-U/tako/master/readme-assets/main_banner.png" width="90%" style="border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">

<br><br>

![Period](<https://img.shields.io/badge/📅_Period-2025.08.07_~_2025.09.29_(7_Weeks)-blue?style=flat-square>)
![Team](<https://img.shields.io/badge/👥_Team-5_Members_(BE_2,_FE_2,_AI_1)-green?style=flat-square>)
![Role](https://img.shields.io/badge/👤_Role-Backend_Developer-orange?style=flat-square)

[![GitHub](https://img.shields.io/badge/GitHub-Repository-181717?style=flat-square&logo=github&logoColor=white)](https://github.com/Me-in-U/tako)

</div>

<br>

<div align="center">

### 💡 핵심 역할

</div>

```txt
⏱️  스케줄러 기반 경매 자동화 시스템 설계 및 구현
⚡  Redis(Lua Script) 활용 실시간 입찰 동시성 제어 및 인기 랭킹 관리
🔔  N-gram 알고리즘 및 FCM/SSE 기반 실시간 알림 서비스 개발
```

<br>

<div align="center">

### 🎯 담당 역할 & 기여도

</div>

<table align="center">
<tr>
<td align="center" width="50%">

**📡 Backend Core**

Spring Batch 경매 자동화  
Redis Lua Script 동시성 제어  
N-gram 검색 엔진 구현  
FCM/SSE 알림 시스템

`기여도: 50%`

</td>
<td align="center" width="50%">

**🔗 Integration**

AWS S3 이미지 관리  
Swagger API 문서화

`기여도: 50%`

</td>
</tr>
</table>

<br>

<div align="center">

### 🛠️ My Tech Stack

<img src="https://img.shields.io/badge/Java%2017-007396?style=flat-square&logo=openjdk&logoColor=white">
<img src="https://img.shields.io/badge/Spring%20Boot%203.5-6DB33F?style=flat-square&logo=springboot&logoColor=white">
<img src="https://img.shields.io/badge/Spring%20Data%20JPA-6DB33F?style=flat-square&logo=spring&logoColor=white">
<img src="https://img.shields.io/badge/Spring%20Batch-6DB33F?style=flat-square&logo=spring&logoColor=white">
<img src="https://img.shields.io/badge/QueryDSL-0078D4?style=flat-square&logo=databricks&logoColor=white">
<img src="https://img.shields.io/badge/Gradle-02303A?style=flat-square&logo=gradle&logoColor=white">
<img src="https://img.shields.io/badge/MySQL-4479A1?style=flat-square&logo=mysql&logoColor=white">
<img src="https://img.shields.io/badge/Redis-DC382D?style=flat-square&logo=redis&logoColor=white">
<img src="https://img.shields.io/badge/JWT-000000?style=flat-square&logo=jsonwebtokens&logoColor=white">
<img src="https://img.shields.io/badge/FCM-FFCA28?style=flat-square&logo=firebase&logoColor=black">
<img src="https://img.shields.io/badge/Web3j-F16822?style=flat-square&logo=web3.js&logoColor=white">
<img src="https://img.shields.io/badge/AWS%20S3-569A31?style=flat-square&logo=amazons3&logoColor=white">
<img src="https://img.shields.io/badge/Docker-2496ED?style=flat-square&logo=docker&logoColor=white">
<img src="https://img.shields.io/badge/Swagger-85EA2D?style=flat-square&logo=swagger&logoColor=black">

</div>

<br>

<div align="center">

### 🧠 기술 선택 이유

</div>

<table align="center">
<tr>
<td width="50%">

**Redis Lua Script**

- 입찰 검증/갱신 **원자성(Atomicity) 보장**
- Race Condition **완전 차단**
- 분산 환경에서 **데이터 정합성 100% 확보**

</td>
<td width="50%">

**Spring Batch**

- 대량 경매 데이터 **자동화 처리**
- 스케줄링 기반 **안정적 마감 처리**
- Chunk 기반 **효율적 리소스 관리**

</td>
</tr>
<tr>
<td width="50%">

**N-gram (Bi-gram)**

- Full Table Scan **제거** (성능 8배 향상)
- **부분 검색 정확도** 92% 달성
- 역색인 기반 **빠른 검색 응답**

</td>
<td width="50%">

**Web3j (Blockchain)**

- 스마트 컨트렉트로 **위변조 방지**
- **투명한 경매 기록** 보장
- 에스크로 **안전한 결제** 구현

</td>
</tr>
</table>

<br>

<div align="center">

### ✨ 주요 기능

</div>

<table align="center">
<tr>
<td align="center" width="25%">

💎  
**투명한 경매**

블록체인 스마트 컨트랙트를 통한 **위변조 불가능한 경매 기록** 및 에스크로 결제

</td>
<td align="center" width="25%">

🤖  
**AI 등급 판정**

객체 탐지 모델(YOLO)을 활용한 **TCG 카드 상태 자동 등급 분류**

</td>
<td align="center" width="25%">

⚡  
**실시간 입찰**

WebSocket 및 Redis를 활용한 **초저지연 실시간 입찰 시스템**

</td>
<td align="center" width="25%">

🔔  
**실시간 알림**

경매 시작/종료, 입찰 경쟁, 낙찰 등 주요 이벤트 **즉각 알림**

</td>
</tr>
</table>

<br>

<div align="center">

### 🚀 성능 개선 & 문제 해결

</div>

<details>
<summary><b>🔥 동시성 이슈 해결 : Redis Lua Script 도입으로 Race Condition 100% 차단</b></summary>

<br>

#### 🚨 Problem

- 인기 경매 마감 직전 다수의 동시 입찰 발생 시 **Race Condition 발생**
- **중복 낙찰 및 입찰가 불일치** 등 데이터 정합성 오류 발생
- 분산 환경(3대 서버)에서 **트랜잭션 간 충돌** 발생
- 실제 테스트 결과: **동시 요청 100건 중 7건 오류 발생**

#### 💡 Solution

1. **Redis Lua Script 도입**

   - 입찰 검증/갱신 로직을 **단일 Lua 스크립트로 통합**
   - 원자적 연산으로 **Race Condition 완전 차단**
   - MULTI/EXEC 대비 **네트워크 라운드트립 70% 감소**

2. **분산 환경 동시성 제어**

   - Redis 분산 락 (Redlock) 패턴 적용
   - **입찰 순서 보장** (timestamp 기반)

3. **로그 기반 디버깅 체계**
   - 모든 입찰 시도 로깅 (Elasticsearch)
   - 정합성 검증 대시보드 구축

#### ✅ Result

- **Race Condition 100% 차단** (동시 요청 1000건 테스트 오류 0건)
- 입찰 처리 응답 속도 **120ms → 45ms로 단축** (62% 향상)
- 분산 환경에서 **데이터 정합성 100% 보장**
- **중복 낙찰 사고 0건** (6주간 운영 기록)

</details>

#### 💡 Solution

- **Redis Lua Script**를 도입하여 입찰 검증 및 갱신 로직의 **원자성(Atomicity)** 보장
- 분산 락(Distributed Lock) 구현으로 동시성 제어 강화

#### ✅ Result

- 데이터 정합성 100% 확보
- 동시 입찰 처리 성능 및 응답 속도 대폭 향상

</details>

<details>
<summary><b>🔍 검색 성능 개선 : N-gram 알고리즘</b></summary>

<br>

#### 🚨 Problem

- 카드명 부분 검색 시 **Like 쿼리**로 인한 Full Table Scan 발생
- 1만 건 이상의 카드 데이터에서 평균 검색 응답 시간 **2.5초** 소요

#### 💡 Solution

- **Bi-gram(2-gram) 토크나이저** 적용하여 검색 인덱스 구축
- 역색인(Inverted Index) 기반 검색 최적화

#### ✅ Result

- 평균 검색 응답 시간 **2.5초 → 0.3초** (약 **8배 성능 향상**)
- 검색 정확도(Precision) **92%** 달성

</details>

<br>

---

<br>

<div align="center">

## 03. 🤖 NAMUH (Tori)

**Vision AI 기반 소아암 환아 케어 휴머노이드 로봇**

<img src="https://github.com/user-attachments/assets/87e637d6-271e-4513-89e7-2aad4aae8f23" width="90%" style="border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">

<br><br>

![Period](<https://img.shields.io/badge/📅_Period-2025.10.14_~_2025.11.23_(6_Weeks)-blue?style=flat-square>)
![Team](<https://img.shields.io/badge/👥_Team-6_Members_(BE_2,_FE_2,_Emb_2)-green?style=flat-square>)
![Role](https://img.shields.io/badge/👤_Role-Embedded_&_Backend_Developer-orange?style=flat-square)

[![GitLab](https://img.shields.io/badge/GitLab-Repository-FC6D26?style=flat-square&logo=gitlab&logoColor=white)](https://lab.ssafy.com/s13-final/S13P31E108)

</div>

<br>

<div align="center">

### 💡 핵심 역할

</div>

```txt
🤖  6축 로봇팔(DOFBOT) 제어 시스템 설계 및 구현
🎭  11+ 감정 표현 모션 라이브러리 개발 (하트, 포옹, 인사 등)
📡  MQTT 기반 실시간 양방향 로봇 제어 프로토콜 설계
👁️  OpenCV 기반 실시간 얼굴 추적(Face Tracking) 시스템 구현
⚙️  멀티스레딩 동시성 제어 및 선점형 명령 처리 시스템 구현
```

<br>

<div align="center">

### 🎯 담당 역할 & 기여도

</div>

<table align="center">
<tr>
<td align="center" width="33%">

**🤖 Embedded Core**

DOFBOT 6축 제어  
11+ 모션 라이브러리  
PID 얼굴 추적  
멀티스레딩 동시성 제어

`기여도: 45%`

</td>
<td align="center" width="33%">

**📡 Integration**

MQTT 프로토콜 설계  
Raspberry Pi 5 설정  
ESP32 통신 구현  
ROS2 연동

`기여도: 30%`

</td>
<td align="center" width="33%">

**📡 Backend**

로봇 제어 API  
명령 큐 관리  
이벤트 처리 시스템

`기여도: 25%`

</td>
</tr>
</table>

<br>

<div align="center">

### 🛠️ My Tech Stack

<img src="https://img.shields.io/badge/Python-3776AB?style=flat-square&logo=python&logoColor=white">
<img src="https://img.shields.io/badge/Arduino-00979D?style=flat-square&logo=arduino&logoColor=white">
<img src="https://img.shields.io/badge/Raspberry%20Pi%205-C51A4A?style=flat-square&logo=raspberrypi&logoColor=white">
<img src="https://img.shields.io/badge/ESP32-214c77?style=flat-square&logo=espressif&logoColor=white">

<img src="https://img.shields.io/badge/MQTT-660066?style=flat-square&logo=mqtt&logoColor=white">
<img src="https://img.shields.io/badge/OpenCV-5C3EE8?style=flat-square&logo=opencv&logoColor=white">
<img src="https://img.shields.io/badge/ROS2-00aaff?style=flat-square&logo=ros&logoColor=white">
<img src="https://img.shields.io/badge/Isaac%20Sim-76B900?style=flat-square&logo=nvidia&logoColor=white">
<img src="https://img.shields.io/badge/Isaac%20Lab-76B900?style=flat-square&logo=nvidia&logoColor=white">
<img src="https://img.shields.io/badge/MoveIt-00aaff?style=flat-square&logo=ros&logoColor=white">

</div>

<br>

<div align="center">

### 🧠 기술 선택 이유

</div>

<table align="center">
<tr>
<td width="50%">

**MQTT Protocol**

- **경량 프로토콜**로 라즈베리파이 적합
- Pub/Sub 구조로 **비동기 양방향 통신**
- QoS 1로 **메시지 전달 보장**
- HTTP 대비 **60% 응답 지연 감소**

</td>
<td width="50%">

**PID Controller**

- **오버슈트 없는 안정적 추적**
- 적분항으로 **정상 상태 오차 제거**
- 미분항으로 **빠른 응답성** 확보
- 2축 독립 제어로 **정밀한 시선 추적**

</td>
</tr>
<tr>
<td width="50%">

**Threading + Lock**

- **서보 명령 충돌 100% 해결**
- Lock 기반 **I/O 직렬화**
- Event 패턴으로 **협력적 취소**
- **선점형 명령 처리** 시스템

</td>
<td width="50%">

**ROS2 + Isaac Sim**

- **실제 환경 시뮬레이션** 가능
- Isaac Lab으로 **강화학습 테스트**
- MoveIt으로 **경로 계획 자동화**
- 표준 ROS 생태계 **확장성**

</td>
</tr>
</table>

<br>

<div align="center">

### ✨ 주요 기능

</div>

<table align="center">
<tr>
<td align="center" width="25%">

🎭  
**감정 표현**

11+ 종류의 세밀한 **양팔 협응 모션**으로 풍부한 감정 전달

</td>
<td align="center" width="25%">

👁️  
**얼굴 추적**

PID 제어 기반 **실시간 얼굴 인식 및 시선 추적**

</td>
<td align="center" width="25%">

😊  
**스마일 포착**

Pre-buffering 기술로 **웃음의 맥락까지 포착**하여 자동 저장

</td>
<td align="center" width="25%">

🧘  
**AI 체조**

MediaPipe 기반 **양방향 체조 인터랙션** 및 동작 교정

</td>
</tr>
</table>

<br>

<div align="center">

### 🚀 성능 개선 & 문제 해결

</div>

<details>
<summary><b>🎯 모션 부드러움 최적화 : Overlap 기반 동작 전환</b></summary>

<br>

#### 🚨 Problem

- 연속 모션 전환 시 각 서보가 목표 각도 도달 후 대기하여 **부자연스러운 끊김 현상** 발생
- 11+ 동작 시퀀스에서 누적되어 전체 UX 저하

#### 💡 Solution

- **Overlap 스케줄링** 도입: 이전 동작 완료 전(80-90% 시점) 다음 동작 시작
- 모션 시퀀스 제어 메서드에 시간차 중첩 기능 구현하여 동작 전환 자동화

#### ✅ Result

- 모션 전환 지연 **50% 이상 감소**
- 자연스러운 흐름으로 **감정 표현 몰입도 향상**

</details>

<details>
<summary><b>⚡ 얼굴 추적 응답성 개선 : PID 제어 알고리즘 도입</b></summary>

<br>

#### 🚨 Problem

- 단순 비례 제어로 인한 과도한 오버슈트 및 진동
- 빠른 얼굴 이동 시 추적 실패 및 부자연스러운 움직임

#### 💡 Solution

- **Positional PID Controller** 구현 (Kp=0.3, Ki=0.1, Kd=0.05)
- 적분항으로 정상 상태 오차 제거, 미분항으로 오버슈트 억제
- S1(수직), S4(수평) 2축 독립 제어로 추적 정확도 향상

#### ✅ Result

- 추적 안정성 및 응답성 **대폭 향상**
- 부드럽고 자연스러운 시선 추적 실현

</details>

<details>
<summary><b>🔧 동시성 제어 : 멀티스레딩 I/O 직렬화</b></summary>

<br>

#### 🚨 Problem

- 얼굴 추적, 모션 제어, MQTT 통신이 동시 실행되어 **서보 명령 충돌** 발생
- 간헐적 각도 오작동 및 제어 불능 상태 진입

#### 💡 Solution

- **threading.Lock** 기반 Arm I/O 직렬화로 동시 접근 방지
- **threading.Event**를 활용한 협력적 취소(Cooperative Cancellation) 패턴 구현
- 선점형(Preemptive) 명령 처리 시스템으로 안전한 동작 전환 보장

#### ✅ Result

- 제어 충돌 **100% 해결**
- 실시간 명령 선점 및 안전한 동작 전환 보장

</details>

<details>
<summary><b>📡 실시간 제어 최적화 : MQTT 프로토콜 설계</b></summary>

<br>

#### 🚨 Problem

- HTTP Polling 방식의 높은 지연 시간으로 실시간 상호작용 불가
- 네트워크 트래픽 과다 및 배터리 소모 증가

#### 💡 Solution

- **MQTT Pub/Sub** 아키텍처 도입 (분리된 토픽: command/event/joint)
- QoS 1 기반 메시지 전달 보장으로 신뢰성 확보
- 양방향 실시간 통신으로 즉각적인 명령-응답 구현

#### ✅ Result

- 명령 응답 지연 시간 **약 60% 감소** (평균 100ms 이하)
- 네트워크 트래픽 **약 40% 절감**

</details>

<br>

<br>

---

<br>

<div align="center">

## 03. 🤖 NAMUH

**MQTT 기반 실시간 제어 감정 표현 휴머노이드 로봇**

<img src="https://raw.githubusercontent.com/Me-in-U/NAMUH/main/readme-assets/namuh_banner.png" width="90%" style="border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">

<br><br>

![Period](<https://img.shields.io/badge/📅_Period-2024.03.05_~_2024.06.20_(15_Weeks)-blue?style=flat-square>)
![Team](<https://img.shields.io/badge/👥_Team-4_Members_(Embedded_2,_Backend_1,_Frontend_1)-green?style=flat-square>)
![Role](https://img.shields.io/badge/👤_Role-Embedded_Lead_&_Backend_Developer-orange?style=flat-square)

</div>

<br>

### 🎯 프로젝트 개요

음성 명령과 얼굴 추적을 통해 사용자와 자연스럽게 상호작용하는 감정 표현 휴머노이드 로봇을 개발했습니다. ESP32 기반 서보 제어, Raspberry Pi 기반 비전 AI, MQTT 실시간 통신을 결합하여 안정적인 분산 제어 시스템을 구현했으며, PID 제어와 멀티스레딩 기반 동시성 제어를 통해 부드러운 움직임과 빠른 반응 속도를 달성했습니다.

**주요 역할:**

- **Embedded Lead (70%)**: ESP32 기반 서보/LED 제어, PID 제어 알고리즘 구현, 6-DOF 로봇팔 17가지 제스처 동작 개발
- **Backend (50%)**: MQTT 브로커 설계 및 통신 프로토콜 정의, Raspberry Pi 메인 제어 시스템 개발

<br>

### 🛠️ 기술 스택

<div align="center">

**Embedded Systems**

![ESP32](https://img.shields.io/badge/ESP32-E7352C?style=for-the-badge&logo=espressif&logoColor=white)
![Raspberry Pi](https://img.shields.io/badge/Raspberry_Pi_5-C51A4A?style=for-the-badge&logo=raspberry-pi&logoColor=white)
![Arduino](https://img.shields.io/badge/Arduino-00979D?style=for-the-badge&logo=arduino&logoColor=white)
![C++](https://img.shields.io/badge/C++-00599C?style=for-the-badge&logo=c%2B%2B&logoColor=white)

**Control & AI**

![Python](https://img.shields.io/badge/Python-3776AB?style=for-the-badge&logo=python&logoColor=white)
![OpenCV](https://img.shields.io/badge/OpenCV-5C3EE8?style=for-the-badge&logo=opencv&logoColor=white)
![PID Control](https://img.shields.io/badge/PID_Control-FF6B6B?style=for-the-badge&logo=data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTEyIDJMMiAxMmwxMCAxMCAxMC0xMEwxMiAyeiIgZmlsbD0iI2ZmZiIvPjwvc3ZnPg==&logoColor=white)
![Picovoice](https://img.shields.io/badge/Picovoice-00C7B7?style=for-the-badge&logo=data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTEyIDJMMiAxMmwxMCAxMCAxMC0xMEwxMiAyeiIgZmlsbD0iI2ZmZiIvPjwvc3ZnPg==&logoColor=white)

**Communication**

![MQTT](https://img.shields.io/badge/MQTT-660066?style=for-the-badge&logo=mqtt&logoColor=white)
![Mosquitto](https://img.shields.io/badge/Mosquitto-3C5280?style=for-the-badge&logo=eclipsemosquitto&logoColor=white)
![WebSocket](https://img.shields.io/badge/WebSocket-010101?style=for-the-badge&logo=socket.io&logoColor=white)

**Hardware**

![DOFBOT](https://img.shields.io/badge/DOFBOT_6DOF-FF9900?style=for-the-badge&logo=data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTEyIDJMMiAxMmwxMCAxMCAxMC0xMEwxMiAyeiIgZmlsbD0iI2ZmZiIvPjwvc3ZnPg==&logoColor=white)
![FastLED](https://img.shields.io/badge/FastLED-00979D?style=for-the-badge&logo=data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTEyIDJMMiAxMmwxMCAxMCAxMC0xMEwxMiAyeiIgZmlsbD0iI2ZmZiIvPjwvc3ZnPg==&logoColor=white)
![PCA9685](https://img.shields.io/badge/PCA9685_PWM-4285F4?style=for-the-badge&logo=data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTEyIDJMMiAxMmwxMCAxMCAxMC0xMEwxMiAyeiIgZmlsbD0iI2ZmZiIvPjwvc3ZnPg==&logoColor=white)

**DevOps**

![Git](https://img.shields.io/badge/Git-F05032?style=for-the-badge&logo=git&logoColor=white)
![GitHub](https://img.shields.io/badge/GitHub-181717?style=for-the-badge&logo=github&logoColor=white)
![Linux](https://img.shields.io/badge/Linux-FCC624?style=for-the-badge&logo=linux&logoColor=black)

</div>

<br>

### 📌 주요 구현 사항

#### 1️⃣ **실시간 로봇 제어 시스템**

<details>
<summary><b>🎮 6축 로봇팔 제스처 제어</b></summary>

<br>

**핵심 기능:**

- DOFBOT 6-DOF 로봇팔 2개를 활용한 **17가지 감정 표현 제스처** 구현
- Easing 함수 기반 부드러운 모션 애니메이션 엔진 개발
- MQTT 기반 실시간 명령 수신 및 State Machine 제어

**구현 제스처:**

```python
# 17가지 제스처 동작 (BotControl/commands/arm_actions/actions.py)
GESTURES = [
    'make_heart',      # 하트 만들기
    'make_hug',        # 포옹 동작
    'hello',           # 인사하기
    'scissors',        # 가위
    'rock',            # 바위
    'paper',           # 보
    'good_morning',    # 굿모닝
    'good_night',      # 굿나잇
    'hungry',          # 배고파
    'ate_all',         # 다 먹었어
    'tiger_roar',      # 호랑이 울음
    'hand_shake',      # 악수
    'salute',          # 경례
    'init_pose',       # 초기 자세
    # + 3가지 추가 동작
]
```

**기술적 특징:**

- **Arm_Lib 라이브러리** 활용 역기구학 계산 (IK Solver)
- **멀티스레딩 동시성 제어**: `threading.Lock` 기반 서보 충돌 방지
- **명령 우선순위 시스템**: MQTT 제어 > 얼굴 추적 자동 동작

#### ✅ Result

- 17가지 제스처 동작 **평균 응답 시간 80ms 이하**
- Race Condition 0% (Lock 기반 동기화)
- 부드러운 모션 애니메이션 (Easing 함수 적용)

</details>

<details>
<summary><b>🎯 PID 제어 기반 얼굴 추적 시스템</b></summary>

<br>

**핵심 기능:**

- OpenCV Haar Cascade 기반 실시간 얼굴 검출
- **PositionalPID 제어** 알고리즘으로 부드러운 서보 각도 조정
- 멀티스레딩 기반 얼굴 추적 & MQTT 제어 병렬 처리

**PID 제어 구현:**

```python
# BotControl/commands/face_tracking/PID.py
class PositionalPID:
    def __init__(self, Kp=0.25, Ki=0.1, Kd=0.05):
        self.Kp = Kp  # 비례 게인
        self.Ki = Ki  # 적분 게인
        self.Kd = Kd  # 미분 게인
        self.error_sum = 0
        self.last_error = 0

    def compute(self, error):
        # P: 비례 제어
        P = self.Kp * error

        # I: 적분 제어 (누적 오차)
        self.error_sum += error
        I = self.Ki * self.error_sum

        # D: 미분 제어 (오차 변화율)
        D = self.Kd * (error - self.last_error)
        self.last_error = error

        return P + I + D
```

**얼굴 추적 제어 흐름:**

```python
# BotControl/commands/face_tracking/controller.py
self._pid_x = PID.PositionalPID(0.25, 0.1, 0.05)  # X축 PID
self._pid_y = PID.PositionalPID(0.25, 0.1, 0.05)  # Y축 PID

# 얼굴 중심 좌표 계산
face_center_x = face_x + face_w / 2
error_x = (frame_width / 2) - face_center_x

# PID 제어로 서보 각도 계산
pid_output = self._pid_x.compute(error_x)
new_angle = current_angle + pid_output

# MQTT로 서보 제어 명령 전송
mqtt_client.publish('buriburi/robot/rx', {
    'cmd': 'track_face',
    'x': new_angle,
    'y': y_angle
})
```

**성능 최적화:**

- ROI(Region of Interest) 설정으로 불필요한 영역 제외
- 다운스케일링 (640x480 → 320x240) 적용
- 프레임 레이트 **22fps → 30fps** 향상

#### ✅ Result

- 얼굴 추적 정확도 **±5° 이내** 유지
- 오버슈트/진동 **약 70% 감소** (비례 제어 대비)
- 프레임 처리 속도 **36% 향상** (30fps 달성)

</details>

<details>
<summary><b>😊 FastLED 기반 감정 표현 시스템</b></summary>

<br>

**핵심 기능:**

- ESP32 + FastLED 라이브러리 기반 **16x16 LED 매트릭스** 제어
- 11가지 감정 표현 애니메이션 구현
- MQTT 실시간 명령으로 표정 전환

**감정 표현 목록:**

```cpp
// FaceControl/expressions.h
EMOTIONS = {
    Neutral,      // 중립
    Happy,        // 행복
    Sad,          // 슬픔
    Angry,        // 화남
    Surprised,    // 놀람
    Thinking,     // 생각중
    Sleeping,     // 잠자는중
    Tracking,     // 추적중 (눈 이동 애니메이션)
    Heart,        // 하트 눈
    Star,         // 별 눈
    Dizzy         // 어지러움
}
```

**LED 매트릭스 제어:**

```cpp
// FaceControl/FaceControl.ino
#include <FastLED.h>

#define LED_PIN 5
#define LED_COUNT 256  // 16x16
CRGB leds[LED_COUNT];

void setup() {
  FastLED.addLeds<WS2812B, LED_PIN, GRB>(leds, LED_COUNT);
  FastLED.setBrightness(50);
}

void showEmotion(String emotion) {
  if (emotion == "Happy") {
    drawHappyFace();
  } else if (emotion == "Tracking") {
    animateTracking();  // 눈 이동 애니메이션
  }
  FastLED.show();
}
```

#### ✅ Result

- 11가지 감정 표현 **즉각 반영** (MQTT 수신 후 50ms 이내)
- LED 애니메이션 **부드러운 전환** (FastLED 라이브러리 활용)
- 256개 LED 동시 제어 **안정적 동작**

</details>

<br>

#### 2️⃣ **Vision AI & 음성 인식**

<details>
<summary><b>👁️ OpenCV 기반 얼굴 추적</b></summary>

<br>

**핵심 기능:**

- Haar Cascade Classifier 기반 실시간 얼굴 검출
- 멀티스레딩 기반 병렬 처리 (얼굴 추적 + MQTT 통신)
- `threading.Lock` 기반 동시성 제어로 Race Condition 방지

**얼굴 검출 파이프라인:**

```python
# BotControl/commands/face_tracking/controller.py
import cv2
import threading

face_cascade = cv2.CascadeClassifier(
    cv2.data.haarcascades + 'haarcascade_frontalface_default.xml'
)

def face_tracking_thread():
    while True:
        ret, frame = camera.read()
        gray = cv2.cvtColor(frame, cv2.COLOR_BGR2GRAY)

        # 얼굴 검출
        faces = face_cascade.detectMultiScale(
            gray, scaleFactor=1.1, minNeighbors=5
        )

        if len(faces) > 0:
            x, y, w, h = faces[0]
            # PID 제어로 서보 각도 계산
            with servo_lock:  # Race Condition 방지
                update_servo_angles(x, y, w, h)
```

**동시성 제어:**

```python
servo_lock = threading.Lock()

# 얼굴 추적 스레드
threading.Thread(target=face_tracking_thread, daemon=True).start()

# MQTT 제어 스레드
threading.Thread(target=mqtt_thread, daemon=True).start()
```

#### ✅ Result

- 얼굴 검출 정확도 **90% 이상** (정면 얼굴 기준)
- Race Condition **0%** (Lock 기반 동기화)
- 프레임 처리 속도 **30fps** 안정적 유지

</details>

<details>
<summary><b>🎤 Picovoice 음성 인식 시스템</b></summary>

<br>

**핵심 기능:**

- Picovoice SDK 기반 "토리" 호출어 인식
- Wake Word Detection → Intent Recognition → MQTT 명령 전송
- TTS(Text-to-Speech) 음성 피드백 시스템

**음성 명령 처리:**

```python
# RaspberryPi/main_pico.py
import pvporcupine
import paho.mqtt.client as mqtt

# Wake Word Detection
porcupine = pvporcupine.create(
    keywords=['토리']
)

def on_wake_word_detected():
    # 음성 명령 인식
    command = recognize_intent()

    # MQTT 명령 전송
    mqtt_client.publish('buriburi/robot/rx', {
        'cmd': command  # 'make_heart', 'hello', etc.
    })

    # TTS 피드백
    tts_speak(f"{command} 명령을 실행합니다")
```

#### ✅ Result

- Wake Word 인식률 **95% 이상**
- 명령 인식 → 동작 실행 **평균 1.2초** 소요
- MQTT 연동으로 실시간 제어 가능

</details>

<br>

#### 3️⃣ **Backend & Integration**

<details>
<summary><b>📡 MQTT 기반 실시간 통신 시스템</b></summary>

<br>

**핵심 기능:**

- Mosquitto 브로커 기반 Pub/Sub 아키텍처
- 4개 ESP32/Raspberry Pi 노드 간 안정적 메시지 전달
- QoS 1 레벨로 메시지 손실 방지

**MQTT 토픽 구조:**

```
buriburi/robot/
├── rx         # 명령 수신 (QoS 1)
│   ├── track_face     # 얼굴 추적 좌표
│   ├── make_heart     # 제스처 명령
│   └── set_emotion    # 표정 변경
├── tx         # 이벤트 발행 (QoS 0)
│   ├── action_done    # 동작 완료
│   └── face_detected  # 얼굴 감지
├── joint      # 조인트 상태 (QoS 0)
│   └── servo_angles   # 현재 서보 각도
└── event      # 시스템 이벤트 (QoS 0)
    └── error          # 에러 발생
```

**통신 프로토콜:**

```python
# BotControl/app_mqtt_sep_topic.py
import paho.mqtt.client as mqtt

client = mqtt.Client()
client.connect("broker.local", 1883, 60)

# 명령 수신
client.subscribe("buriburi/robot/rx", qos=1)

def on_message(client, userdata, msg):
    command = json.loads(msg.payload)

    if command['cmd'] == 'make_heart':
        execute_gesture('make_heart')
    elif command['cmd'] == 'track_face':
        update_servo(command['x'], command['y'])

    # 완료 이벤트 발행
    client.publish("buriburi/robot/tx", {
        'event': 'action_done',
        'cmd': command['cmd']
    }, qos=0)
```

**ESP32 MQTT 클라이언트:**

```cpp
// BackboneControl/mqtt_helpers.h
#include <PubSubClient.h>

WiFiClient espClient;
PubSubClient client(espClient);

void callback(char* topic, byte* payload, unsigned int length) {
  StaticJsonDocument<256> doc;
  deserializeJson(doc, payload);

  String cmd = doc["cmd"];

  if (cmd == "track_face") {
    int x = doc["x"];
    int y = doc["y"];
    moveServo(NECK_X, x);
    moveServo(NECK_Y, y);
  }
}

client.subscribe("buriburi/robot/rx", 1);  // QoS 1
```

#### ✅ Result

- 명령 응답 지연 **평균 80ms** (HTTP 대비 60% 감소)
- 메시지 손실률 **0%** (QoS 1 + 재연결 메커니즘)
- 4개 노드 동시 연결 **안정적 동작**

</details>

<details>
<summary><b>🎛️ 관리자 대시보드 (MQTT 기반)</b></summary>

<br>

**핵심 기능:**

- MQTT WebSocket 연동 실시간 로봇 상태 모니터링
- 17가지 제스처 수동 제어 UI
- 서보 각도 실시간 시각화 (Joint State)

**대시보드 기능:**

```javascript
// frontend-dashboard/src/mqtt.js
import mqtt from "mqtt";

const client = mqtt.connect("ws://broker.local:9001");

client.subscribe("buriburi/robot/joint");
client.subscribe("buriburi/robot/tx");

client.on("message", (topic, message) => {
	const data = JSON.parse(message.toString());

	if (topic === "buriburi/robot/joint") {
		// 서보 각도 시각화
		updateServoVisualization(data.angles);
	} else if (topic === "buriburi/robot/tx") {
		// 이벤트 로그 표시
		appendLog(data.event);
	}
});

// 제스처 제어 버튼
function sendGestureCommand(gesture) {
	client.publish(
		"buriburi/robot/rx",
		JSON.stringify({
			cmd: gesture, // 'make_heart', 'hello', etc.
		}),
		{ qos: 1 }
	);
}
```

#### ✅ Result

- 실시간 로봇 상태 **지연 100ms 이내** 반영
- 17가지 제스처 **원클릭 제어** 가능
- 서보 각도 시각화로 **디버깅 효율 향상**

</details>

<br>

### 🎖️ 담당 역할 & 기여도

<table>
<tr>
<td width="50%">

**🔧 Embedded Lead (70%)**

- ESP32 기반 서보 제어 시스템 설계 및 구현
- 6-DOF 로봇팔 17가지 제스처 동작 개발
- PID 제어 알고리즘 구현 (Kp=0.25, Ki=0.1, Kd=0.05)
- FastLED 기반 16x16 LED 매트릭스 감정 표현 시스템
- 멀티스레딩 동시성 제어 (threading.Lock 기반)

</td>
<td width="50%">

**🌐 Backend (50%)**

- MQTT 브로커 설계 및 통신 프로토콜 정의
- Pub/Sub 아키텍처 기반 4개 노드 통신 구현
- QoS 레벨 설정 및 메시지 신뢰성 보장
- Raspberry Pi 메인 제어 시스템 개발
- 얼굴 추적 & 음성 인식 통합

</td>
</tr>
</table>

<br>

### 🏆 프로젝트 성과

<details>
<summary><b>🎯 PID 제어 기반 안정적 얼굴 추적 달성</b></summary>

<br>

#### ⚠️ Problem

초기 비례 제어(P-Control)만 사용 시 다음 문제 발생:

- **오버슈트 심각**: 목표 각도 도달 후 20% 이상 초과 회전
- **진동(Oscillation) 발생**: 목표 위치 주변에서 지속적인 흔들림
- **정상 상태 오차**: ±10° 이상의 오차 누적

#### 💡 Solution

**PositionalPID 제어 알고리즘 도입:**

```python
# PID 파라미터 튜닝 과정
# 초기값: Kp=1.0, Ki=0, Kd=0 → 오버슈트 30%
# 1차 튜닝: Kp=0.5, Ki=0.05, Kd=0.02 → 오버슈트 15%
# 최종값: Kp=0.25, Ki=0.1, Kd=0.05 → 오버슈트 5% 이하

self._pid_x = PID.PositionalPID(0.25, 0.1, 0.05)
```

**주요 개선 사항:**

- **P(비례) 제어**: 현재 오차에 비례하여 제어 → 빠른 반응
- **I(적분) 제어**: 누적 오차 보상 → 정상 상태 오차 제거
- **D(미분) 제어**: 오차 변화율 기반 감쇠 → 오버슈트 방지

#### ✅ Result

| 지표               | 비례 제어 (Before) | PID 제어 (After) | 개선율       |
| ------------------ | ------------------ | ---------------- | ------------ |
| **오버슈트**       | 20~30%             | 5% 이하          | **70% 감소** |
| **정상 상태 오차** | ±10°               | ±2°              | **80% 감소** |
| **안정화 시간**    | 1.5초              | 0.5초            | **67% 단축** |
| **진동 발생**      | 심각               | 미미             | **90% 감소** |

</details>

<details>
<summary><b>🔄 멀티스레딩 동시성 제어로 시스템 안정성 확보</b></summary>

<br>

#### ⚠️ Problem

얼굴 추적과 MQTT 제어가 동시에 서보를 조작하여 발생한 문제:

- **Race Condition**: 2개 스레드가 동시에 서보 각도 변경 시도
- **서보 충돌**: 상반된 명령으로 인한 비정상 동작
- **명령 손실**: MQTT 명령이 얼굴 추적에 의해 무시됨

#### 💡 Solution

**threading.Lock 기반 동기화 메커니즘:**

```python
servo_lock = threading.Lock()
_arm_io_lock = threading.Lock()

# 얼굴 추적 스레드
def face_tracking_thread():
    while True:
        # 얼굴 검출
        faces = detect_faces(frame)

        if faces:
            with servo_lock:  # Critical Section
                update_servo_angles(faces[0])

# MQTT 제어 스레드
def mqtt_command_thread():
    while True:
        command = mqtt_queue.get()

        with servo_lock:  # Critical Section
            execute_gesture(command)
```

**명령 우선순위 시스템:**

```python
# MQTT 제어가 항상 우선
if mqtt_queue.qsize() > 0:
    with servo_lock:
        execute_mqtt_command()
else:
    # MQTT 명령 없을 때만 얼굴 추적
    if face_detected:
        with servo_lock:
            track_face()
```

#### ✅ Result

- Race Condition **0%** (Lock 기반 동기화)
- 명령 충돌 **완전 해결**
- MQTT 제어 우선순위 **100% 보장**

</details>

<details>
<summary><b>📡 MQTT 프로토콜 도입으로 통신 효율 대폭 향상</b></summary>

<br>

#### ⚠️ Problem

초기 HTTP Polling 방식의 문제점:

- **높은 지연 시간**: 평균 200ms (Polling 주기 100ms + 처리 시간)
- **불필요한 트래픽**: 빈 응답 반복 수신 (80% 이상)
- **서버 부하**: 초당 40회 HTTP 요청 (4개 노드 x 10Hz)

#### 💡 Solution

**MQTT Pub/Sub 아키텍처로 전환:**

- 분리된 토픽 구조: `rx`(명령), `tx`(이벤트), `joint`(상태)
- QoS 1 기반 메시지 전달 보장
- 이벤트 기반 통신으로 불필요한 Polling 제거

#### ✅ Result

| 지표                | HTTP Polling (Before) | MQTT (After) | 개선율        |
| ------------------- | --------------------- | ------------ | ------------- |
| **명령 응답 지연**  | 평균 200ms            | 평균 80ms    | **60% 감소**  |
| **네트워크 트래픽** | 40 req/s              | 5~10 msg/s   | **75% 절감**  |
| **메시지 손실률**   | 5~10%                 | 0%           | **완전 해결** |
| **서버 CPU 사용률** | 40%                   | 15%          | **62% 감소**  |

</details>

<br>

### 💭 프로젝트 리뷰

<table align="center">
<tr>
<td width="50%">

**🔍 아쉬웠던 점**

PID 제어와 MQTT 통신으로 안정적인 시스템을 구축했으나, ROS(Robot Operating System)를 도입하지 못한 점이 아쉬움. ROS의 tf(Transform) 라이브러리를 활용했다면 3D 공간 좌표 변환이 더 정확했을 것이며, rosbag을 통한 센서 데이터 기록/재생으로 디버깅 효율을 크게 높일 수 있었을 것. 또한 강화학습을 적용하지 못해 자율적인 감정 표현 학습이 불가능했음

</td>
<td width="50%">

**✨ 배운 점**

PID 제어 이론을 실제 임베디드 시스템에 적용하며 제어 공학의 중요성을 체감. Kp, Ki, Kd 파라미터 튜닝 과정에서 시행착오를 겪으며 실시간 피드백 루프의 동작 원리를 깊이 이해할 수 있었음. 또한 멀티스레딩 환경에서 Race Condition을 해결하며 동시성 제어 역량을 크게 향상시켰으며, MQTT 프로토콜 설계를 통해 분산 시스템 아키텍처의 효율적인 설계 방법을 습득

</td>
</tr>
</table>

<br>

---

<div align="center">

## 🔗 Links

[![GitHub](https://img.shields.io/badge/GitHub-Me--in--U-181717?style=for-the-badge&logo=github&logoColor=white)](https://github.com/Me-in-U)
[![Email](https://img.shields.io/badge/Email-contact@ios.kr-EA4335?style=for-the-badge&logo=gmail&logoColor=white)](mailto:contact@ios.kr)
[![Discord](https://img.shields.io/badge/Discord-namu.wiki-5865F2?style=for-the-badge&logo=discord&logoColor=white)](https://discord.com)
[![KakaoTalk](https://img.shields.io/badge/KakaoTalk-namu.wiki-FFCD00?style=for-the-badge&logo=kakaotalk&logoColor=black)](https://open.kakao.com/o/sC7iaK3h)

<br>

**💬 함께 성장하는 개발자가 되고 싶습니다!**

</div>
